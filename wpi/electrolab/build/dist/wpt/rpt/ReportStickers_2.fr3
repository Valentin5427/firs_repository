<?xml version="1.0" encoding="utf-8" standalone="no"?>
<TfrxReport Version="4.9.8" DotMatrixReport="False" EngineOptions.UseFileCache="True" IniFile="\Software\Fast Reports" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.ConnectionName="Electrolab" ReportOptions.CreateDate="42634.3666380324" ReportOptions.Description.Text="" ReportOptions.LastChange="43530.943251794" ScriptLanguage="PascalScript" ScriptText.Text="var pre_coil: string;                                            &#13;&#10;  &#13;&#10;procedure Memo3OnBeforePrint(Sender: TfrxComponent);&#13;&#10;// Очищение повторяющихся номеров обмоток                                                                                          &#13;&#10;begin     &#13;&#10;//showmessage(IntToStr(&#60;ADOQuery1.&#34;serial_number&#34;&#62;));                                                                                  &#13;&#10;   if pre_coil &#60;&#62; &#60;ADOQuery2.&#34;coil&#34;&#62; then&#13;&#10;   begin                    &#13;&#10;       Memo3.Text := &#60;ADOQuery2.&#34;coil&#34;&#62;;  &#13;&#10;       pre_coil := &#60;ADOQuery2.&#34;coil&#34;&#62;;  &#13;&#10;       Memo3.Frame.TopLine.Color := clBlack                                                                                     &#13;&#10;   end                    &#13;&#10;   else&#13;&#10;   begin               &#13;&#10;       Memo3.Text := '';  &#13;&#10;       Memo3.Frame.TopLine.Color := clWhite&#13;&#10;   end            &#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;    if &#60;item&#62; = 0 then                                                      &#13;&#10;      ADOQuery1.SQL.Delete(7);  &#13;&#10;end;&#13;&#10;&#13;&#10;procedure Memo11OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;//showmessage(IntToStr(&#60;ADOQuery1.&#34;serial_number&#34;&#62;));                                                                                  &#13;&#10;  &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;   if &#60;type_test&#62; = 1 then&#13;&#10;   begin               &#13;&#10;     Memo8.Text := '[ADOQuery2.&#34;scA&#34;]';                                                      &#13;&#10;     Memo9.Text := '[ADOQuery2.&#34;scP&#34;]'&#13;&#10;   end;               &#13;&#10;   if &#60;type_test&#62; = 2 then&#13;&#10;   begin               &#13;&#10;     Memo8.Text := '[ADOQuery2.&#34;apA&#34;]';                                                      &#13;&#10;     Memo9.Text := '[ADOQuery2.&#34;apP&#34;]'&#13;&#10;   end;               &#13;&#10;   pre_coil := '';                                              &#13;&#10;   if Null &#60;&#62; &#60;ConnectionString&#62; then ADODataBase1.DatabaseName := &#60;ConnectionString&#62;;&#13;&#10;end.&#13;&#10;  " PropData="0844617461736574730101062C20446174615365743D2241444F5175657279312220446174615365744E616D653D2241444F517565727931220001062C20446174615365743D2241444F5175657279322220446174615365744E616D653D2241444F517565727932220000095661726961626C65730101060C204E616D653D22205661722200010C0F030000204E616D653D22436F6E6E656374696F6E537472696E67222056616C75653D222750726F76696465723D4D53444153514C2E313B5065727369737420536563757269747920496E666F3D46616C73653B557365722049443D656C656374726F6C61623B4461746120536F757263653D506F737467726553514C3335573B457874656E6465642050726F706572746965733D262333343B44534E3D506F737467726553514C3335573B44415441424153453D656C6563743B5345525645523D6C6F63616C686F73743B504F52543D353433323B5549443D656C656374726F6C61623B70617373776F72643D656C656374726F6C61623B53534C6D6F64653D64697361626C653B526561644F6E6C793D303B50726F746F636F6C3D372E343B46616B654F6964496E6465783D303B53686F774F6964436F6C756D6E3D303B526F7756657273696F6E696E673D303B53686F7753797374656D5461626C65733D303B436F6E6E53657474696E67733D3B46657463683D3130303B536F636B65743D343039363B556E6B6E6F776E53697A65733D303B4D61785661726368617253697A653D3235353B4D61784C6F6E675661726368617253697A653D383139303B44656275673D303B436F6D6D4C6F673D303B4F7074696D697A65723D303B4B73716F3D313B5573654465636C61726546657463683D303B5465787441734C6F6E67566172636861723D313B556E6B6E6F776E7341734C6F6E67566172636861723D303B426F6F6C734173436861723D313B50617273653D303B43616E63656C41734672656553746D743D303B45787472615379735461626C6550726566697865733D64645F3B4C46436F6E76657273696F6E3D313B557064617461626C65437572736F72733D313B446973616C6C6F775072656D61747572653D303B5472756549734D696E7573313D303B42493D303B427974656141734C6F6E6756617242696E6172793D303B55736553657276657253696465507265706172653D303B4C6F776572436173654964656E7469666965723D303B477373417574685573654753533D303B58614F70743D31262333343B27220001061F204E616D653D22746573745F6D6170222056616C75653D223135373238372200010616204E616D653D226974656D222056616C75653D2230220001061B204E616D653D22747970655F74657374222056616C75653D2231220000055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxADODatabase Name="ADODatabase1" LoginPrompt="False" PropData="05704C65667402600470546F70038400"/>
    <TfrxADOQuery Name="ADOQuery1" UserName="ADOQuery1" CloseDataSource="False" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="select t1.id as item, t1.serial_number, makedate||'-'||serialnumber as zavnum, ordernumber, series, &#13;&#10;to_char(t3.createdatetime, 'dd.mm.yy') as date, t4.fio as fio, t5.fullname                                                                                                &#13;&#10;from item t1, serial_number t2, test_map t3, operator t4, stand t5                          &#13;&#10;where t1.serial_number = t2.id&#13;&#10;and t1.test_map = t3.id&#13;&#10;and t3.operator = t4.id&#13;&#10;and t3.stand = t5.id&#13;&#10;and t1.id = :item                                                   &#13;&#10;and test_map = :test_map                   &#13;&#10;--and test_map = 52877&#13;&#10;order by item        &#13;&#10;  " CommandTimeout="30" Database="ADODatabase1" LockType="ltReadOnly" PropData="05704C65667402600470546F7003CC000A506172616D65746572730101063D204E616D653D226974656D222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B6974656D262336323B2200010645204E616D653D22746573745F6D6170222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B746573745F6D6170262336323B220000"/>
    <TfrxADOQuery Name="ADOQuery2" UserName="ADOQuery2" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" Master="ADOQuery1" IgnoreDupParams="False" SQL.Text="select&#13;&#10;    sn.id&#13;&#10;--    , 'И' || cast(cl.coilnumber as varchar ) || '-И' || cast(cl.tap as varchar )  as coil&#13;&#10;    , cast(cl.coilnumber as varchar ) || 'И1-' || cast(cl.coilnumber as varchar ) || 'И' || cast(cl.tap as varchar ) as coil&#13;&#10;    , coalesce(scChecking.quadroload, coalesce(apChecking.quadroload, coalesce(ltChecking.quadroload, cl.secondload))) as secondload&#13;&#10;    , points.ipercent&#13;&#10;    , scChecking.quadroload as quadroloadForOrder              &#13;&#10;    , cl.secondload as secondloadForOrder                      &#13;&#10;    , scChecking.a as scA                   &#13;&#10;    , scChecking.p as scP                &#13;&#10;    , apChecking.a as apA                &#13;&#10;    , apChecking.p as apP                &#13;&#10;    , ltChecking.a as ltA                &#13;&#10;    , ltChecking.p as ltP&#13;&#10;    , scitem.acceptdatetime::date as scdate&#13;&#10;    , apitem.acceptdatetime::date as apdate&#13;&#10;    , ltitem.acceptdatetime::date as ltdate&#13;&#10;    , scop.fio as scfio&#13;&#10;    , apop.fio as apfio&#13;&#10;    , ltop.fio as ltfio&#13;&#10;from &#13;&#10;    serial_number sn&#13;&#10;inner join&#13;&#10;    coil cl&#13;&#10;on&#13;&#10;    cl.transformer = sn.transformer&#13;&#10;inner join&#13;&#10;    gost_detail points&#13;&#10;on &#13;&#10;    points.gost_id = 1&#13;&#10;    and  points.classaccuracy = cl.classaccuracy&#13;&#10;left join&#13;&#10;    item scItem&#13;&#10;on&#13;&#10;--scItem.id = item and&#13;&#10;    scItem.serial_number = sn.id&#13;&#10;    and scItem.acceptdatetime = (&#13;&#10;      select &#13;&#10;        max(item.acceptdatetime) &#13;&#10;      from &#13;&#10;        item&#13;&#10;      inner join&#13;&#10;        test_map tm&#13;&#10;      on&#13;&#10;          item.test_map = tm.id&#13;&#10;      inner join&#13;&#10;          stand&#13;&#10;      on&#13;&#10;          stand.id = tm.stand&#13;&#10;      inner join&#13;&#10;          test_type tt&#13;&#10;      on&#13;&#10;          tt.id = stand.test_type&#13;&#10;      where&#13;&#10;        item.serial_number = :serial_number                                       &#13;&#10;        and&#13;&#10;        tt.code = 0 -- code of test type&#13;&#10;    )&#13;&#10;left join&#13;&#10;    checking scChecking&#13;&#10;on&#13;&#10;    scChecking.item = scItem.id&#13;&#10;    and scChecking.point = points.ipercent&#13;&#10;    and scChecking.coil = cl.id&#13;&#10;    and scChecking.quadroload is not null = points.usequadro&#13;&#10;left join&#13;&#10;    item apItem&#13;&#10;on&#13;&#10;--apItem.id = item and&#13;&#10;    apItem.serial_number = sn.id&#13;&#10;    and apItem.acceptdatetime = (&#13;&#10;      select &#13;&#10;        max(item.acceptdatetime) &#13;&#10;      from &#13;&#10;        item&#13;&#10;      inner join&#13;&#10;        test_map tm&#13;&#10;      on&#13;&#10;          item.test_map = tm.id&#13;&#10;      inner join&#13;&#10;          stand&#13;&#10;      on&#13;&#10;          stand.id = tm.stand&#13;&#10;      inner join&#13;&#10;          test_type tt&#13;&#10;      on&#13;&#10;          tt.id = stand.test_type&#13;&#10;      where&#13;&#10;        item.serial_number = :serial_number_2       &#13;&#10;        and tt.code = 2 -- code of test type&#13;&#10;    )&#13;&#10;left join&#13;&#10;    checking apChecking&#13;&#10;on&#13;&#10;    apChecking.item = apItem.id&#13;&#10;    and apChecking.point = points.ipercent&#13;&#10;    and apChecking.coil = cl.id&#13;&#10;    and apChecking.quadroload is not null = points.usequadro&#13;&#10;left join&#13;&#10;    item ltItem&#13;&#10;on&#13;&#10;--ltItem.id = item and&#13;&#10;    ltItem.serial_number = sn.id&#13;&#10;    and ltItem.acceptdatetime = (&#13;&#10;      select &#13;&#10;        max(item.acceptdatetime) &#13;&#10;      from &#13;&#10;        item&#13;&#10;      inner join&#13;&#10;        test_map tm&#13;&#10;      on&#13;&#10;          item.test_map = tm.id&#13;&#10;      inner join&#13;&#10;          stand&#13;&#10;      on&#13;&#10;          stand.id = tm.stand&#13;&#10;      inner join&#13;&#10;          test_type tt&#13;&#10;      on&#13;&#10;          tt.id = stand.test_type&#13;&#10;      where&#13;&#10;        item.serial_number = :serial_number_3       &#13;&#10;        and tt.code = 1 -- code of test type&#13;&#10;    )&#13;&#10;left join&#13;&#10;    checking ltChecking&#13;&#10;on&#13;&#10;    ltChecking.item = ltItem.id&#13;&#10;    and ltChecking.point = points.ipercent&#13;&#10;    and ltChecking.coil = cl.id&#13;&#10;    and ltChecking.quadroload is not null = points.usequadro&#13;&#10;left join&#13;&#10;      test_map sctm&#13;&#10;on&#13;&#10;      sctm.id = scItem.test_map&#13;&#10;left join&#13;&#10;      operator scop&#13;&#10;on&#13;&#10;      scop.id = sctm.operator&#13;&#10;--&#13;&#10;left join&#13;&#10;      test_map aptm&#13;&#10;on&#13;&#10;      aptm.id = apItem.test_map&#13;&#10;left join&#13;&#10;      operator apop&#13;&#10;on&#13;&#10;      apop.id = aptm.operator&#13;&#10;--&#13;&#10;left join&#13;&#10;      test_map lttm&#13;&#10;on&#13;&#10;      lttm.id = ltItem.test_map&#13;&#10;left join&#13;&#10;      operator ltop&#13;&#10;on&#13;&#10;      ltop.id = lttm.operator&#13;&#10;    &#13;&#10;where&#13;&#10;sn.id = :serial_number_4       &#13;&#10;order by scchecking.chektimestamp&#13;&#10;      " CommandTimeout="30" Database="ADODatabase1" LockType="ltReadOnly" PropData="05704C65667402600470546F700320010A506172616D657465727301010663204E616D653D2273657269616C5F6E756D626572222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B41444F5175657279312E262333343B73657269616C5F6E756D626572262333343B262336323B2200010665204E616D653D2273657269616C5F6E756D6265725F32222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B41444F5175657279312E262333343B73657269616C5F6E756D626572262333343B262336323B2200010665204E616D653D2273657269616C5F6E756D6265725F33222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B41444F5175657279312E262333343B73657269616C5F6E756D626572262333343B262336323B2200010665204E616D653D2273657269616C5F6E756D6265725F34222044617461547970653D226674496E7465676572222045787072657373696F6E3D22262336303B41444F5175657279312E262333343B73657269616C5F6E756D626572262333343B262336323B220000"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" PaperWidth="58" PaperHeight="80" PaperSize="256" LeftMargin="1" RightMargin="1" TopMargin="1" BottomMargin="1" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxMasterData Name="MasterData1" Height="43.46458646" Left="0" Top="18.89765" Width="211.65368" ColumnWidth="0" ColumnGap="0" DataSet="ADOQuery1" DataSetName="ADOQuery1" RowCount="0" StartNewPage="True">
      <TfrxMemoView Name="Memo2" Left="0" Top="0" Width="64.25201" Height="15.11812" ShowHint="False" DataSet="ADOQuery1" DataSetName="ADOQuery1" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="1" ParentFont="False" Text="[ADOQuery1.&#34;zavnum&#34;]"/>
      <TfrxMemoView Name="Memo5" Left="71.81107" Top="30.23624" Width="49.13389" Height="13.22834646" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="I ном (%)"/>
      <TfrxMemoView Name="Memo6" Left="120.94496" Top="30.23624" Width="45.35436" Height="13.22834646" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="f (%)"/>
      <TfrxMemoView Name="Memo7" Left="166.29932" Top="30.23624" Width="45.35436" Height="13.22834646" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="Δ (')"/>
      <TfrxMemoView Name="Memo1" Left="64.25201" Top="0" Width="41.57483" Height="15.11812" ShowHint="False" DataSet="ADOQuery1" DataSetName="ADOQuery1" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[ADOQuery1.&#34;date&#34;]"/>
      <TfrxMemoView Name="Memo10" Left="105.82684" Top="0" Width="105.82684" Height="15.11812" ShowHint="False" DataField="fio" DataSet="ADOQuery1" DataSetName="ADOQuery1" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[ADOQuery1.&#34;fio&#34;]"/>
      <TfrxMemoView Name="Memo11" Left="0" Top="30.23624" Width="71.81107" Height="13.22834646" OnBeforePrint="Memo11OnBeforePrint" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="Обм."/>
      <TfrxMemoView Name="Memo12" Left="0" Top="15.11812" Width="211.65368" Height="15.11812" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="Arial" Font.Style="0" ParentFont="False" Text="[ADOQuery1.&#34;fullname&#34;]"/>
    </TfrxMasterData>
    <TfrxDetailData Name="DetailData1" Height="13.22834646" Left="0" Top="86.92919" Width="211.65368" ColumnWidth="0" ColumnGap="0" DataSet="ADOQuery2" DataSetName="ADOQuery2" RowCount="0">
      <TfrxMemoView Name="Memo3" Left="0" Top="0" Width="71.81107" Height="13.22834646" OnBeforePrint="Memo3OnBeforePrint" ShowHint="False" DataSet="ADOQuery2" DataSetName="ADOQuery2" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[ADOQuery2.&#34;coil&#34;]"/>
      <TfrxMemoView Name="Memo4" Left="71.81107" Top="0" Width="49.13389" Height="13.22834646" ShowHint="False" DataSet="ADOQuery2" DataSetName="ADOQuery2" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[ADOQuery2.&#34;ipercent&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="120.94496" Top="0" Width="45.35436" Height="13.22834646" ShowHint="False" DataSet="ADOQuery2" DataSetName="ADOQuery2" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[ADOQuery2.&#34;scA&#34;]"/>
      <TfrxMemoView Name="Memo9" Left="166.29932" Top="0" Width="45.35436" Height="13.22834646" ShowHint="False" DataSet="ADOQuery2" DataSetName="ADOQuery2" Font.Charset="1" Font.Color="-16777208" Font.Height="-9" Font.Name="Arial" Font.Style="1" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[ADOQuery2.&#34;scP&#34;]"/>
    </TfrxDetailData>
  </TfrxReportPage>
</TfrxReport>
